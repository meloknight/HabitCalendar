@using HabitCalendar.Models
@model CalendarInfoModel;

@{
    ViewData["Title"] = "Home Page";
}

<section id="calendar-section">

    <div id="days-of-week-container">
        <div class="day-of-week">Sunday</div>
        <div class="day-of-week">Monday</div>
        <div class="day-of-week">Tuesday</div>
        <div class="day-of-week">Wednesday</div>
        <div class="day-of-week">Thursday</div>
        <div class="day-of-week">Friday</div>
        <div class="day-of-week">Saturday</div>
    </div>

    <div id="greater-calendar-container">
        @{
            DateOnly todaysDate = DateOnly.FromDateTime(DateTime.Today);
            <div class="side-calendar-area">
                @{
                    if (Model.currentWeek.Count > 0){
                        <div class="side-container"> - @todaysDate.Month / @todaysDate.Year - </div>
                    }

                    if (Model.remainingWeeks.Count > 0) {
                        int weekIncrementer = 0;
                        bool isNewMonth = false;
                        foreach(CalendarDisplayModel day in Model.remainingWeeks){
                            if (weekIncrementer >= 7){ weekIncrementer = 0; }
                            if (day.Date.Day == 1) {
                                isNewMonth = true;
                            }
                            if (weekIncrementer == 6) {
                                if (isNewMonth == true) {
                                    <div class="side-container">
                                        <i class="fa-solid fa-arrow-up"></i>
                                        <div>
                                            @day.Date.Month / @day.Date.Year
                                        </div>
                                    </div>
                                } else {
                                    <div class="side-container"></div>
                                }
                                isNewMonth = false;
                            }
                            weekIncrementer++;
                        }
                    }

                    if (Model.firstWeek.Count > 0) {
                        bool isNewMonthInFirstWeek = false;
                        foreach (CalendarDisplayModel day in Model.firstWeek) {
                            if (day.Date.Day == 1) {
                                isNewMonthInFirstWeek = true;
                            }
                        }
                        if (isNewMonthInFirstWeek == true) {
                            <div class="side-container"> - @todaysDate.Month - @todaysDate.Year - </div>

                        } else {
                            <div class="side-container"></div>
                        }
                    }
                }

            </div>
        }
        <div id="calendar-container">
            @{
                if (Model != null) {
                    DateOnly currentDate = DateOnly.FromDateTime(DateTime.Today);
                    foreach(CalendarDisplayModel curr in Model.currentWeek){
                        if(curr.isVisible == true && curr.Date == currentDate){
                            <div class="day-container current-day">@curr.Date.Day</div>
                        }   
                        else if (curr.isVisible == true) {
                            <div class="day-container">@curr.Date.Day</div>
                        } else {
                            <div class="day-container day-not-visible"></div>
                        }
                    }
                }
            }

            @{
                if (Model != null && Model.remainingWeeks.Count > 0)
                {
                    foreach (CalendarDisplayModel remain in Model.remainingWeeks)
                    {
                        if (remain.isVisible == true)
                        {
                            <div class="day-container">@remain.Date.Day</div>
                        }
                        else
                        {
                            <div class="day-container day-not-visible"></div>
                        }
                    }
                }
            }

            @{
                if (Model != null && Model.firstWeek.Count > 0)
                {
                    foreach (CalendarDisplayModel first in Model.firstWeek)
                    {
                        if (first.isVisible == true)
                        {
                            <div class="day-container">@first.Date.Day</div>
                        }
                        else
                        {
                            <div class="day-container day-not-visible"></div>
                        }
                    }
                }
            }
        </div>

        <div class="side-calendar-area">
            @{
                int weeksCountRightSide = 0;
                if (Model.currentWeek.Count > 0) { weeksCountRightSide++; }
                if (Model.firstWeek.Count > 0) { weeksCountRightSide++; }
                if (Model.remainingWeeks.Count > 0) {
                    weeksCountRightSide += Model.remainingWeeks.Count / 7;
                }
                for (int i = 0; i < weeksCountRightSide; i++) {
                    <div class="side-container"></div>
                }
            }
            </div>
        </div>
    </section>